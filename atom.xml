<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title><![CDATA[Absyah Playground]]></title>
  
  <link href="/atom.xml" rel="self"/>
  <link href="http://absyah.github.io/"/>
  <updated>2015-12-12T10:26:11.000Z</updated>
  <id>http://absyah.github.io/</id>
  
  <author>
    <name><![CDATA[Ardian Bahtiarsyah]]></name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title><![CDATA[No More Horror Issue 'It Works on My Machine' RoR Development Using Vagrant & Chef]]></title>
    <link href="http://absyah.github.io/2015/12/12/No-More-Horror-Issue-It-Works-on-My-Machine-RoR-Development-Using-Vagrant-Chef/"/>
    <id>http://absyah.github.io/2015/12/12/No-More-Horror-Issue-It-Works-on-My-Machine-RoR-Development-Using-Vagrant-Chef/</id>
    <published>2015-12-12T08:06:00.000Z</published>
    <updated>2015-12-12T10:26:11.000Z</updated>
    <content type="html"><![CDATA[<p>“Kok dilokalku g jalan gini app nya?”</p>
<p>Sering ngalamin masalah itu? Dimana ketika suatu fitur dapat berjalan di lokal developer lain, sedangkan di lokal kita error disana-sini / bahkan app tersebut tidak dapat berjalan sama sekali.</p>
<p>Yep, saya sering mengalaminya dan sekarang ada solusinya!</p>
<a id="more"></a>
<h1 id="Vagrant"><a href="#Vagrant" class="headerlink" title="Vagrant"></a>Vagrant</h1><p>Vagrant adalah sebuah tool yang secara otomatis melakukan setup development environment didalam mesin virtual didalam komputer. Anda akan dapat melakukan <code>ssh</code> dari lokal komputer host menuju lokal pada mesin virtual.</p>
<p>Dengan demikian, <em>development environment</em> Anda akan dapat sama persis dengan <em>production environment</em> dan juga dapat didistribusikan kepada seluruh team kolaborasi Anda sehingga mereka juga memiliki environment yang sama tidak peduli jenis konfigurasi komputer / laptop yang digunakan untuk development. <em>Awesome!</em></p>
<h1 id="Chef"><a href="#Chef" class="headerlink" title="Chef"></a>Chef</h1><p>Chef adalah sebuah tool yang dapat melakukan otomatisasi setup untuk virtual mesin / server, misalnya instal DBMS, ruby, dan prerequisites lainnya yang dibutuhkan dalam sebuah development aplikasi.</p>
<p>Dengan demikian kita tidak perlu melakukan instalasi satu persatu kebutuhan konfigurasi yang diperlukan.</p>
<h5 id="STEP_1_-_Installation"><a href="#STEP_1_-_Installation" class="headerlink" title="STEP 1 - Installation"></a>STEP 1 - Installation</h5><ul>
<li>Install <a href="https://vagrantup.com/downloads" target="_blank" rel="external">vagrant</a></li>
<li>Install <a href="https://www.virtualbox.org/wiki/Downloads" target="_blank" rel="external">virtualbox</a></li>
<li><p>Install vagrant plugin :</p>
<ul>
<li><code>$ vagrant plugin install vagrant-vbguest</code>, install otomatis host dari VirtualBox Guest Additions</li>
<li><code>$ vagrant plugin install vagrant-librarian-chef</code>, memberitahu vagrant untuk running Chef ketika vagrant dijalankan</li>
</ul>
</li>
<li><p><code>$ cd to/root/app_directory</code></p>
</li>
<li><p><code>$ vagrant init</code>, akan menggenerate vagrantfile pada root directory aplikasi</p>
</li>
<li><code>$ touch Cheffile</code>, akan membuat Cheffile pada root directory aplikasi</li>
</ul>
<h5 id="STEP_2_-_Configuration"><a href="#STEP_2_-_Configuration" class="headerlink" title="STEP 2 - Configuration"></a>STEP 2 - Configuration</h5><p>Buka file Cheffile, lalu tambahkan code berikut :<br><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">site <span class="string">"http://community.opscode.com/api/v1"</span></span><br><span class="line"></span><br><span class="line">cookbook <span class="string">'apt'</span></span><br><span class="line">cookbook <span class="string">'build-essential'</span></span><br><span class="line">cookbook <span class="string">'mysql'</span>, <span class="string">'5.5.3'</span></span><br><span class="line">cookbook <span class="string">'ruby_build'</span></span><br><span class="line">cookbook <span class="string">'nodejs'</span>, <span class="string">git:</span> <span class="string">'https://github.com/mdxp/nodejs-cookbook'</span></span><br><span class="line">cookbook <span class="string">'rbenv'</span>, <span class="string">git:</span> <span class="string">'https://github.com/fnichol/chef-rbenv'</span></span><br><span class="line">cookbook <span class="string">'vim'</span></span><br></pre></td></tr></table></figure></p>
<p>Pada Cheffile tersebut disebutkan prerequisites pada virtual mesin, dan ketika vagrant dijalankan untuk pertama kalinya akan secara otomatis melakukan installasi prerequisites tersebut.</p>
<hr>
<p>Buka Vagrantfile yang telah tergenerate sebelumnya. Akan ada banyak konfigurasi pada file tersebut. Untuk sekarang kita hanya membutuhkan konfigurasi sebagai berikut :</p>
<figure class="highlight elixir"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- mode: ruby -*-</span></span><br><span class="line"><span class="comment"># vi: set ft=ruby :</span></span><br><span class="line"></span><br><span class="line"><span class="constant">VAGRANTFILE_API_VERSION </span>= <span class="string">"2"</span></span><br><span class="line"></span><br><span class="line"><span class="constant">Vagrant.</span>configure(<span class="constant">VAGRANTFILE_API_VERSION)</span> <span class="keyword">do</span> |config|</span><br><span class="line">  <span class="comment"># Use Ubuntu 14.04 Trusty Tahr 64-bit as our operating system</span></span><br><span class="line">  config.vm.box = <span class="string">"ubuntu/trusty64"</span></span><br><span class="line"></span><br><span class="line">  <span class="comment"># Configurate the virtual machine to use 2GB of RAM</span></span><br><span class="line">  config.vm.provider <span class="symbol">:virtualbox</span> <span class="keyword">do</span> |vb|</span><br><span class="line">    vb.customize [<span class="string">"modifyvm"</span>, <span class="symbol">:id</span>, <span class="string">"--memory"</span>, <span class="string">"2048"</span>]</span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">  <span class="comment"># Forward the Rails server default port to the host</span></span><br><span class="line">  config.vm.network <span class="symbol">:forwarded_port</span>, <span class="symbol">guest:</span> <span class="number">3000</span>, <span class="symbol">host:</span> <span class="number">8080</span></span><br><span class="line"></span><br><span class="line">  <span class="comment"># Use Chef Solo to provision our virtual machine</span></span><br><span class="line">  config.vm.provision <span class="symbol">:chef_solo</span> <span class="keyword">do</span> |chef|</span><br><span class="line">    chef.cookbooks_path = [<span class="string">"cookbooks"</span>]</span><br><span class="line"></span><br><span class="line">    chef.add_recipe <span class="string">"apt"</span></span><br><span class="line">    chef.add_recipe <span class="string">"nodejs"</span></span><br><span class="line">    chef.add_recipe <span class="string">"ruby_build"</span></span><br><span class="line">    chef.add_recipe <span class="string">"rbenv::user"</span></span><br><span class="line">    chef.add_recipe <span class="string">"rbenv::vagrant"</span></span><br><span class="line">    chef.add_recipe <span class="string">"vim"</span></span><br><span class="line">    chef.add_recipe <span class="string">"mysql::server"</span></span><br><span class="line">    chef.add_recipe <span class="string">"mysql::client"</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># Install Ruby 2.1.2 and Bundler</span></span><br><span class="line">    <span class="comment"># Set an empty root password for MySQL to make things simple</span></span><br><span class="line">    chef.json = &#123;</span><br><span class="line">      <span class="symbol">rbenv:</span> &#123;</span><br><span class="line">        <span class="symbol">user_installs:</span> [&#123;</span><br><span class="line">          <span class="symbol">user:</span> <span class="string">'vagrant'</span>,</span><br><span class="line">          <span class="symbol">rubies:</span> [<span class="string">"2.1.2"</span>],</span><br><span class="line">          <span class="symbol">global:</span> <span class="string">"2.1.2"</span>,</span><br><span class="line">          <span class="symbol">gems:</span> &#123;</span><br><span class="line">            <span class="string">"2.1.2"</span> =&gt; [</span><br><span class="line">              &#123; <span class="symbol">name:</span> <span class="string">"bundler"</span> &#125;</span><br><span class="line">            ]</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;]</span><br><span class="line">      &#125;,</span><br><span class="line">      <span class="symbol">mysql:</span> &#123;</span><br><span class="line">        <span class="symbol">server_root_password:</span> <span class="string">''</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>
<p><code>add_recipe</code> akan meng<em>include receipe</em> dari Cheffile kita ketika vagrant dijalankan.</p>
<p>Anda dapat menambahkan <em>receipes</em> sesuai kebutuhan Anda (tambahkan di Cheffile dan include di Vagrantfile). Untuk daftar <em>receipes</em> dapat Anda temukan pada repository <a href="https://github.com/opscode-cookbooks" target="_blank" rel="external">opscode-cookbooks</a></p>
<hr>
<h5 id="STEP_3_-_Running_Vagrant"><a href="#STEP_3_-_Running_Vagrant" class="headerlink" title="STEP 3 - Running Vagrant"></a>STEP 3 - Running Vagrant</h5><ul>
<li><code>$ vagrant up</code>, Proses ini akan memakan waktu lama untuk pertamakalinya karena akan melakukan installasi OS sesuai konfigurasi dan <em>prerequisites</em> yang dibutuhkan. Untuk selanjutnya akan sangat lebih cepat karena semua configurasi telah terinstall</li>
<li>(additional info) Ketika Anda melakukan perubahan pada Vagrantfile dan Cheffile, maka Anda perlu untuk melakukan <code>$ vagrant provision</code></li>
<li>(additional info) ketika vagrant telah <code>up</code> dan Anda ingin mematikan virtual mesin Anda, cukup dengan <code>$ vagrant halt</code></li>
<li><code>$ vagrant ssh</code>, perintah ini akan melakukan ssh ke virtual mesin</li>
<li>Ketika telah masuk ke ssh mesin virtual, pindah ke shared directory antara host dan virtual mesin <code>$ cd /vagrant</code>. Anda dapat mengecek dengan <code>$ ls</code> untuk memastikan directory pada virtual mesin memiliki isi sama persis dengan directory aplikasi pada host komputer Anda</li>
<li>Jalankan perintah dasar Ruby on Rails (<code>bundle</code>, <code>db:create</code>, <code>db:migrate</code>, dsb sampai <code>rails s</code>)</li>
<li>Buka browser seperti biasa, dan akses <code>localhost:port</code> Anda</li>
</ul>
<p>Berikut adalah output yang akan tampil pada terminal ketika melakukan <code>$ vagrant up</code> dan <code>$ vagrant ssh</code><br><figure class="highlight vala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="preprocessor"># The commented lines are the output you should see when you run these commands</span></span><br><span class="line"></span><br><span class="line">vagrant up</span><br><span class="line"><span class="preprocessor">#==&gt; default: Checking if box 'ubuntu/trusty64' is up to date...</span></span><br><span class="line"><span class="preprocessor">#==&gt; default: Clearing any previously set forwarded ports...</span></span><br><span class="line"><span class="preprocessor">#==&gt; default: Installing Chef cookbooks with Librarian-Chef...</span></span><br><span class="line"><span class="preprocessor">#==&gt; default: The cookbook path '/Users/chris/code/test_app/site-cookbooks' doesn't exist. Ignoring...</span></span><br><span class="line"><span class="preprocessor">#==&gt; default: Clearing any previously set network interfaces...</span></span><br><span class="line"><span class="preprocessor">#==&gt; default: Preparing network interfaces based on configuration...</span></span><br><span class="line"><span class="preprocessor">#    default: Adapter 1: nat</span></span><br><span class="line"><span class="preprocessor">#==&gt; default: Forwarding ports...</span></span><br><span class="line"><span class="preprocessor">#    default: 3000 =&gt; 8080 (adapter 1)</span></span><br><span class="line"><span class="preprocessor">#    default: 22 =&gt; 2222 (adapter 1)</span></span><br><span class="line"><span class="preprocessor">#==&gt; default: Running 'pre-boot' VM customizations...</span></span><br><span class="line"><span class="preprocessor">#==&gt; default: Booting VM...</span></span><br><span class="line"><span class="preprocessor">#==&gt; default: Waiting for machine to boot. This may take a few minutes...</span></span><br><span class="line"><span class="preprocessor">#    default: SSH address: 127.0.0.1:2222</span></span><br><span class="line"><span class="preprocessor">#    default: SSH username: vagrant</span></span><br><span class="line"><span class="preprocessor">#    default: SSH auth method: private key</span></span><br><span class="line"><span class="preprocessor">#    default: Warning: Connection timeout. Retrying...</span></span><br><span class="line"><span class="preprocessor">#==&gt; default: Machine booted and ready!</span></span><br><span class="line"><span class="preprocessor">#==&gt; default: Checking for guest additions in VM...</span></span><br><span class="line"><span class="preprocessor">#==&gt; default: Mounting shared folders...</span></span><br><span class="line"><span class="preprocessor">#    default: /vagrant =&gt; /Users/chris/code/test_app</span></span><br><span class="line"><span class="preprocessor">#   default: /tmp/vagrant-chef-1/chef-solo-1/cookbooks =&gt; /Users/chris/code/test_app/cookbooks</span></span><br><span class="line"><span class="preprocessor">#==&gt; default: VM already provisioned. Run `vagrant provision` or use `--provision` to force it</span></span><br><span class="line"></span><br><span class="line">vagrant ssh</span><br><span class="line"><span class="preprocessor">#Welcome to Ubuntu 14.04 LTS (GNU/Linux 3.13.0-24-generic x86_64)</span></span><br><span class="line"><span class="preprocessor">#</span></span><br><span class="line"><span class="preprocessor"># * Documentation:  https://help.ubuntu.com/</span></span><br><span class="line"><span class="preprocessor">#</span></span><br><span class="line"><span class="preprocessor"># System information disabled due to load higher than 1.0</span></span><br><span class="line"><span class="preprocessor">#</span></span><br><span class="line"><span class="preprocessor">#  Get cloud support with Ubuntu Advantage Cloud Guest:</span></span><br><span class="line"><span class="preprocessor">#    http://www.ubuntu.com/business/services/cloud</span></span><br><span class="line"><span class="preprocessor">#</span></span><br><span class="line"><span class="preprocessor">#</span></span><br><span class="line"><span class="preprocessor">#vagrant@vagrant-ubuntu-trusty-64:~$</span></span><br></pre></td></tr></table></figure></p>
<p>Perlu diketahui, pada Vagrantfile terdapat konfigurasi <code>config.vm.network :forwarded_port, guest: 3000, host: 8080</code>, maksudnya adalah ketika anda running di virtual mesin pada <code>port 3000</code> maka untuk menampilkan aplikasi pada browser harus pada <code>port 8080</code>.</p>
<p>Ketika Anda menginginkan environment terdistribusi memiliki <em>state</em> yang sama (misal data pada database, dsb) Anda dapat menjalankan perintah <code>$ vagrant package</code>. Perintah tersebut akan menggenerate <em>box</em>, dan Anda dapat memberikan kepada team kolaborasi Anda sehingga mereka memiliki development environment yang sama dengan yang Anda miliki.</p>
<p>Untuk daftar CLI vagrant, dapat ditemukan pada <a href="https://docs.vagrantup.com/v2/cli" target="_blank" rel="external">Vagrant Command-Line Interface</a></p>
<hr>
<p>Vagrant memberikan kemudahan kepada team kolaborasi untuk dapat memiliki environment yang sama antara satu dengan yang lain, sehingga horror <strong>It works on my machine</strong> tidak akan terjadi lagi (:</p>
]]></content>
    <summary type="html">
    <![CDATA[<p>“Kok dilokalku g jalan gini app nya?”</p>
<p>Sering ngalamin masalah itu? Dimana ketika suatu fitur dapat berjalan di lokal developer lain, sedangkan di lokal kita error disana-sini / bahkan app tersebut tidak dapat berjalan sama sekali.</p>
<p>Yep, saya sering mengalaminya dan sekarang ada solusinya!</p>]]>
    
    </summary>
    
      <category term="DevOps" scheme="http://absyah.github.io/all-tags/DevOps/"/>
    
      <category term="RubyOnRails" scheme="http://absyah.github.io/all-tags/RubyOnRails/"/>
    
  </entry>
  
</feed>
